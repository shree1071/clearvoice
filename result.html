<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearVoice - Results</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, #f8fafc, #e2e8f0);
            color: #333;
        }
        .container {
            max-width: 1000px;
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 30px auto;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        h1, h3 {
            color: #4f46e5;
        }
        .summary-box, .insight-box, .improvement-box {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #f1f5f9;
            border: 1px solid #e2e8f0;
        }
        .category-review {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background-color: #f9fafb;
        }
        .chart-container {
            margin-top: 20px;
        }
        .feedback-box {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #d1d5db;
            border-radius: 10px;
            background-color: #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Title -->
        <h1 class="text-center">ClearVoice - Workplace Feedback Report</h1>

        <!-- Summary and AI Analysis -->
        <div class="summary-box">
            <h3>Overall Rating</h3>
            <p id="summaryText"></p>
        </div>
        <div class="insight-box">
            <h3>AI-Driven Insights</h3>
            <p id="insightBox"></p>
        </div>

        <!-- Bar Chart -->
        <div class="chart-container">
            <h3>Category Ratings</h3>
            <canvas id="barChart"></canvas>
        </div>

        <!-- User Reviews -->
        <h3 class="mt-4">Your Feedback</h3>
        <div id="detailedReviews"></div>

        <!-- Improvement Suggestions -->
        <h3 class="mt-4">Recommendations for Improvement</h3>
        <div class="improvement-box" id="improvementBox"></div>

        <!-- Charts -->
        <div class="chart-container">
            <h3>Ratings Overview</h3>
            <canvas id="radarChart"></canvas>
            <canvas id="pieChart" class="mt-4"></canvas>
        </div>

        <!-- My Feedback -->
        <div class="feedback-box">
            <h3>Expert Feedback</h3>
            <p>
                Based on the provided feedback and analysis, the following observations are made:
            </p>
            <ul>
                <li>
                    The strongest category, <strong id="strongestCategory"></strong>, reflects excellent performance, indicating this area can serve as a model for other categories.
                </li>
                <li>
                    The weakest category, <strong id="weakestCategory"></strong>, requires immediate attention. Focus on addressing specific issues mentioned in the userâ€™s feedback to improve this area.
                </li>
                <li>
                    Low ratings in multiple categories suggest the need for targeted workshops, leadership training, or communication improvements to foster better engagement and satisfaction.
                </li>
            </ul>
            <p>
                Overall, the feedback form is well-structured, allowing for both quantitative and qualitative inputs. Future iterations could incorporate:
            </p>
            <ul>
                <li>
                    Follow-up actions or surveys to track improvements over time.
                </li>
                <li>
                    Integration of peer comparisons to benchmark performance against industry standards.
                </li>
                <li>
                    Enhanced visualization options to better identify trends in feedback data.
                </li>
            </ul>
            <p>
                ClearVoice demonstrates a commitment to improving workplace satisfaction. The insights gained here should guide meaningful actions to address areas of concern.
            </p>
        </div>
    </div>

    <script>
        // Fetch Feedback Data
        const feedbackData = JSON.parse(localStorage.getItem("feedbackData")) || {};
        const categories = ["Work-Life Balance", "Management Support", "Peer Collaboration", "Career Growth", "Transparency"];
        const scores = [
            parseInt(feedbackData.balance?.rating) || 0,
            parseInt(feedbackData.management?.rating) || 0,
            parseInt(feedbackData.collaboration?.rating) || 0,
            parseInt(feedbackData.growth?.rating) || 0,
            parseInt(feedbackData.transparency?.rating) || 0
        ];
        const reviews = [
            feedbackData.balance?.description || "No feedback provided.",
            feedbackData.management?.description || "No feedback provided.",
            feedbackData.collaboration?.description || "No feedback provided.",
            feedbackData.growth?.description || "No feedback provided.",
            feedbackData.transparency?.description || "No feedback provided."
        ];

        // Calculate Summary
        const avgScore = scores.reduce((a, b) => a + b, 0) / scores.length;
        document.getElementById("summaryText").innerHTML = `
            <strong>Average Score:</strong> ${avgScore.toFixed(2)}<br>
            ${avgScore >= 4 ? "Your workplace is performing well overall!" :
                avgScore >= 3 ? "Your workplace has moderate performance with room for improvement." :
                "Your workplace needs immediate improvement in key areas."}
        `;

        // AI Insights
        const strongestCategory = categories[scores.indexOf(Math.max(...scores))];
        const weakestCategory = categories[scores.indexOf(Math.min(...scores))];
        document.getElementById("insightBox").innerHTML = `
            The strongest area is <strong>${strongestCategory}</strong>.<br>
            The weakest area is <strong>${weakestCategory}</strong>.<br>
            Focus on improving low-rated categories to boost overall satisfaction.
        `;
        document.getElementById("strongestCategory").textContent = strongestCategory;
        document.getElementById("weakestCategory").textContent = weakestCategory;

        // User Feedback
        const detailedReviews = document.getElementById("detailedReviews");
        detailedReviews.innerHTML = categories.map((cat, i) => `
            <div class="category-review">
                <h5>${cat}</h5>
                <p><strong>Rating:</strong> ${scores[i]}</p>
                <p><strong>Feedback:</strong> ${reviews[i]}</p>
            </div>
        `).join("");

        // Improvement Suggestions
        const improvementBox = document.getElementById("improvementBox");
        improvementBox.innerHTML = categories.map((cat, i) => {
            if (scores[i] >= 4) return `<p><strong>${cat}:</strong> No improvements needed. Great work!</p>`;
            return `
                <div class="category-review">
                    <h5>${cat}</h5>
                    <ul>
                        <li>Identify challenges by conducting focused surveys.</li>
                        <li>Implement team workshops to address concerns.</li>
                        <li>Increase communication and transparency in this area.</li>
                    </ul>
                </div>
            `;
        }).join("");

        // Bar Chart
        const barCtx = document.getElementById("barChart").getContext("2d");
        new Chart(barCtx, {
            type: "bar",
            data: {
                labels: categories,
                datasets: [{
                    label: "Ratings",
                    data: scores,
                    backgroundColor: ["#22c55e", "#4ade80", "#facc15", "#f87171", "#60a5fa"]
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: true, max: 5, ticks: { stepSize: 1 } }
                }
            }
        });

        // Radar Chart
        const radarCtx = document.getElementById("radarChart").getContext("2d");
        new Chart(radarCtx, {
            type: "radar",
            data: {
                labels: categories,
                datasets: [{
                    label: "Ratings Overview",
                    data: scores,
                    fill: true,
                    backgroundColor: "rgba(72, 187, 120, 0.2)",
                    borderColor: "#48bb78"
                }]
            },
            options: {
                responsive: true,
                scales: { r: { suggestedMin: 0, suggestedMax: 5 } }
            }
        });

        // Pie Chart
        const pieCtx = document.getElementById("pieChart").getContext("2d");
        new Chart(pieCtx, {
            type: "pie",
            data: {
                labels: ["Poor", "Below Average", "Average", "Good", "Excellent"],
                datasets: [{
                    data: [1, 2, 3, 4, 5].map(r => scores.filter(s => s === r).length),
                    backgroundColor: ["#f87171", "#facc15", "#60a5fa", "#4ade80", "#22c55e"]
                }]
            }
        });
    </script>
</body>
</html>
